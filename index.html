<!DOCTYPE html>
<html lang="ro">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mini eMag</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <!-- NAVBAR -->
    <nav>
        <div class="logo">
            <span style="color:#0057ff;">Mini</span><span style="color:#ff2c2c;"> eMag</span>
        </div>
        <div class="nav-links">
            <a href="#">Acasă</a>
            <a href="#">Produse</a>
            <a href="#">Contact</a>
            <div class="cart">
                Coș: <span id="cart-count">0</span>
                <button id="view-cart-btn">Vezi coș</button>
            </div>
        </div>
    </nav>

    <!-- BANNER -->
    <div class="banner">
        <h1>Bine ai venit la MiniMag!</h1>
        <p>Cele mai bune produse la un click distanță</p>
    </div>

    <!-- LOGIN/SIGNUP -->
    <div class="auth-container">
        <input type="email" id="email" placeholder="Email">
        <input type="password" id="password" placeholder="Parolă">
        <button onclick="signupUser()">Creează cont</button>
        <button onclick="loginUser()">Loghează-te</button>
        <button onclick="logoutUser()">Deloghează-te</button>
        <button type="button" onclick="loginWithGoogle()">Loghează-te cu Google</button>
    </div>

    <!-- FILTRE -->
    <div class="filter-container">
        <input type="text" id="search" placeholder="Caută produse...">
        <select id="category-filter">
            <option value="All">Toate categoriile</option>
            <option value="Telefoane">Telefoane</option>
            <option value="Laptopuri">Laptopuri</option>
            <option value="Accesorii">Accesorii</option>
            <option value="Tablete">Tablete</option>
            <option value="Televizoare">Televizoare</option>
        </select>
        <select id="sort-filter">
            <option value="none">Sortare</option>
            <option value="asc">Preț crescător</option>
            <option value="desc">Preț descrescător</option>
        </select>
        <button onclick="addProduct()">Adaugă produs</button>
    </div>

    <!-- PRODUSE -->
    <div class="container">
        <div class="products" id="products"></div>
    </div>

    <!-- COȘ -->
    <div id="cart-container" class="cart-container" style="display:none;">
        <h2>Coșul tău</h2>
        <ul id="cart-items"></ul>
        <p>Total: <span id="cart-total">0</span> RON</p>
        <button id="close-cart">Închide</button>
    </div>

    <footer>
        &copy; 2025 Mini eMag | Toate drepturile rezervate
    </footer>

    <!-- SCRIPTURI -->
    <script type="module">
        // ========================
        // FIREBASE INIT
        // ========================
        import { initializeApp } from "https://www.gstatic.com/firebasejs/12.7.0/firebase-app.js";
        import { getAnalytics } from "https://www.gstatic.com/firebasejs/12.7.0/firebase-analytics.js";
        import { 
            getAuth, createUserWithEmailAndPassword, signInWithEmailAndPassword, signOut, GoogleAuthProvider, signInWithPopup
        } from "https://www.gstatic.com/firebasejs/12.7.0/firebase-auth.js";
        import { 
            getFirestore, collection, addDoc, onSnapshot, query, orderBy 
        } from "https://www.gstatic.com/firebasejs/12.7.0/firebase-firestore.js";

        const firebaseConfig = {
            apiKey: "AIzaSyB8IUYlmq4kceZhC3gp6e8Mk9G7eLzrYvM",
            authDomain: "minimag-7ad90.firebaseapp.com",
            projectId: "minimag-7ad90",
            storageBucket: "minimag-7ad90.firebasestorage.app",
            messagingSenderId: "685055029064",
            appId: "1:685055029064:web:8e2fe8f8b689245dd24d7d",
            measurementId: "G-SCMXR51H2G"
        };

        const app = initializeApp(firebaseConfig);
        const analytics = getAnalytics(app);
        const auth = getAuth(app);
        const db = getFirestore(app);

        // ========================
        // PRODUSE DEMO
        // ========================
        const demoProducts = [
            {title: "Telefon Galaxy S23", description: "Telefon performant cu cameră excelentă", price: 4500, image: "https://source.unsplash.com/400x300/?smartphone"},
            {title: "Laptop MacBook Air", description: "Laptop ușor și rapid", price: 7500, image: "https://source.unsplash.com/400x300/?laptop"},
            {title: "Căști Sony WH-1000XM5", description: "Căști wireless cu anulare zgomot", price: 1200, image: "https://source.unsplash.com/400x300/?headphones"},
            {title: "Televizor Samsung 55\"", description: "TV 4K Smart, ecran mare", price: 3800, image: "https://source.unsplash.com/400x300/?tv"},
            {title: "Tabletă iPad Air", description: "Tabletă compactă cu ecran Retina", price: 3200, image: "https://source.unsplash.com/400x300/?tablet"},
            {title: "Telefon iPhone 14", description: "Telefon pentru gaming și fotografie", price: 6800, image: "https://source.unsplash.com/400x300/?iphone"},
            {title: "Laptop Dell XPS 13", description: "Laptop performant pentru muncă", price: 6000, image: "https://source.unsplash.com/400x300/?dell-laptop"},
            {title: "Căști Bose QuietComfort", description: "Căști cu bass puternic și confortabile", price: 1300, image: "https://source.unsplash.com/400x300/?bose-headphones"},
            {title: "Televizor LG OLED", description: "TV Smart cu culori vii", price: 4900, image: "https://source.unsplash.com/400x300/?oled-tv"},
            {title: "Tabletă Samsung Galaxy Tab", description: "Tabletă pentru divertisment și muncă", price: 2800, image: "https://source.unsplash.com/400x300/?samsung-tablet"}
        ];

        const productsDiv = document.getElementById('products');

        function createProductCard(p) {
            const card = document.createElement('div');
            card.className = 'product-card';
            card.innerHTML = `
                <span class="badge-new">NOU</span>
                <img src="${p.image}" alt="${p.title}">
                <h3>${p.title}</h3>
                <p class="product-desc">${p.description}</p>
                <p class="price">${p.price} RON</p>
                <button onclick="addToCart('${p.title}', ${p.price})">Adaugă în coș</button>
                <button onclick="contactSeller('${p.title}')">Contactează vânzătorul</button>
            `;
            card.style.opacity = 0;
            productsDiv.appendChild(card);
            setTimeout(() => {
                card.style.opacity = 1;
                card.style.transition = 'opacity 0.6s ease, transform 0.3s ease';
            }, 50);
        }

        demoProducts.forEach(createProductCard);

        // ========================
        // PRODUSE DIN FIRESTORE
        // ========================
        const productsCol = collection(db, 'products');
        const q = query(productsCol, orderBy('timestamp', 'desc'));

        onSnapshot(q, snapshot => {
            snapshot.forEach(doc => {
                const data = doc.data();
                createProductCard(data);
            });
        });

        // ========================
        // AUTENTIFICARE EMAIL/PAROLĂ
        // ========================
        window.signupUser = async function() {
            const email = document.getElementById('email').value;
            const password = document.getElementById('password').value;
            try {
                await createUserWithEmailAndPassword(auth, email, password);
                alert('Cont creat cu succes!');
                document.getElementById('email').value = '';
                document.getElementById('password').value = '';
            } catch(e) { alert(e.message); }
        }

        window.loginUser = async function() {
            const email = document.getElementById('email').value;
            const password = document.getElementById('password').value;
            try {
                await signInWithEmailAndPassword(auth, email, password);
                alert('Te-ai logat cu succes!');
                document.getElementById('email').value = '';
                document.getElementById('password').value = '';
            } catch(e) { alert(e.message); }
        }

        window.logoutUser = async function() {
            try {
                await signOut(auth);
                alert('Te-ai delogat!');
            } catch(e) { alert(e.message); }
        }

        // ========================
        // LOGIN GOOGLE
        // ========================
        const provider = new GoogleAuthProvider();
        window.loginWithGoogle = async function() {
            try {
                const result = await signInWithPopup(auth, provider);
                const user = result.user;
                alert(`Te-ai logat cu succes, ${user.displayName}!`);
            } catch (error) {
                console.error(error);
                alert(`Eroare la logarea cu Google: ${error.message}`);
            }
        }

        // ========================
        // ADĂUGARE PRODUS
        // ========================
        window.addProduct = async function() {
            const title = prompt("Titlu produs:");
            const description = prompt("Descriere produs:");
            const price = parseFloat(prompt("Preț produs:"));
            const image = prompt("URL imagine:");
            if(title && description && price && image){
                await addDoc(productsCol, {title, description, price, image, timestamp: new Date()});
                alert('Produs adăugat cu succes!');
            } else { 
                alert('Completează toate câmpurile!'); 
            }
        }

        // ========================
        // COȘ
        // ========================
        window.addToCart = function(title, price){
            const cartItems = document.getElementById('cart-items');
            const cartTotal = document.getElementById('cart-total');
            const item = document.createElement('li');
            item.textContent = `${title} - ${price} RON`;
            cartItems.appendChild(item);
            cartTotal.textContent = (parseFloat(cartTotal.textContent) + price).toFixed(2);
            item.style.transform = 'translateX(100px)';
            item.style.opacity = 0;
            setTimeout(() => {
                item.style.transition = 'transform 0.4s ease, opacity 0.4s ease';
                item.style.transform = 'translateX(0)';
                item.style.opacity = 1;
            }, 50);
        }

        const cartContainer = document.getElementById('cart-container');
        document.getElementById('view-cart-btn').onclick = function(){
            cartContainer.classList.add('show');
            cartContainer.classList.remove('hide');
        }
        document.getElementById('close-cart').onclick = function(){
            cartContainer.classList.remove('show');
            cartContainer.classList.add('hide');
        }

        // ========================
        // CONTACT VÂNZĂTOR
        // ========================
        window.contactSeller = function(productName) {
            const message = prompt(`Trimite mesaj vânzătorului pentru produsul: ${productName}`);
            if(message) {
                alert(`Mesajul tău a fost trimis: "${message}"\n(Vânzătorul va fi notificat)`);
            }
        }

        // ========================
        // DARK MODE
        // ========================
        window.toggleDarkMode = function() {
            document.body.classList.toggle('dark-mode');
        }

    </script>
</body>
</html>
